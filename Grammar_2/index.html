<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Tracery</title>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="scripts/tracery.js"></script>
  </head>
  <body>
    <div id="img"></div>
    <button id="refresh">Another one</button>
    <script>
      var grammar;
      var data = {
        "hexDigit":["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "A", "B", "C", "D", "E", "F"],
        "digit":["0", "1", "2", "3", "4", "5", "6", "7", "8", "9"],
        "colorHex":["\##hexDigit##hexDigit##hexDigit##hexDigit##hexDigit##hexDigit#"],
        "color":["purple", "pink", "yellow", "blue", "black"],
        "shape":["rect width=\"#num#\" height=\"#num#\" x=\"#num#\" y=\"#num#\"", "circle cx=\"#num#\" cy=\"#num#\" r=\"#num#\"", "polygon points=\"#num#,#num# #num#,#num# #num#,#num#\""],
        "num":["#digit##digit#"],
        "stroke":["stroke=\"#color#\" stroke-width=\"#digit#\" stroke-opacity=\"0.#digit#\""],
        "fill":["fill=\"#color#\" fill-opacity=\"0.#digit#\""],
        "makeShape":["<#shape# #stroke# #fill# />"],
        "bg":["<rect width='300' height='300' x='-50' y='-50' fill='#color#' />"],

        "origin":["<svg width=\"200\" height=\"200\">#bg##makeShape##makeShape##makeShape##makeShape##makeShape##makeShape##makeShape#</svg>"]
      }
      grammar = tracery.createGrammar(data);
      img = grammar.flatten('#origin#');
      document.getElementById("img").innerHTML = img;
      document.getElementById("refresh").addEventListener("click", newImage);

      function newImage(){
        console.log("click!");
        img = grammar.flatten('#origin#');
        document.getElementById("img").innerHTML = img;
      }
    </script>
  </body>
</html>
